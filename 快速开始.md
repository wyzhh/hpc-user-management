# HPCç”¨æˆ·ç®¡ç†ç³»ç»Ÿ - å¿«é€Ÿå¼€å§‹

## ğŸš€ ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

### 1. é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp backend/.env.ldap.example backend/.env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹LDAPæœåŠ¡å™¨ä¿¡æ¯
vim backend/.env
```

**é‡è¦é…ç½®é¡¹ï¼š**
```bash
# LDAPæœåŠ¡å™¨é…ç½®
LDAP_URL=ldap://your-ldap-server.com:389
LDAP_BIND_DN=cn=admin,dc=your-company,dc=com
LDAP_BIND_PASSWORD=your-admin-password
LDAP_BASE_DN=dc=your-company,dc=com

# æŒ‡å®šLDAPç”¨æˆ·ä½œä¸ºç®¡ç†å‘˜ï¼ˆé€—å·åˆ†éš”ï¼‰
LDAP_ADMIN_USERS=pi001,your-admin-user
```

### 2. å¯åŠ¨ç³»ç»Ÿ
```bash
# å®Œæ•´å¯åŠ¨ï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰
./start-system.sh

# å¼€å‘æ¨¡å¼å¯åŠ¨
./start-system.sh --dev

# è·³è¿‡åˆå§‹åŒ–ç›´æ¥å¯åŠ¨
./start-system.sh --skip-init

# ä»…å¯åŠ¨DockeræœåŠ¡
./start-system.sh --docker-only
```

### 3. è®¿é—®ç³»ç»Ÿ
- **å‰ç«¯**: http://localhost:3000
- **åç«¯API**: http://localhost:8000
- **LDAPç®¡ç†**: http://localhost:8080

### 4. åœæ­¢ç³»ç»Ÿ
```bash
./stop-system.sh
```

## ğŸ”§ æ‰‹åŠ¨å¯åŠ¨ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

### 1. å¯åŠ¨åŸºç¡€æœåŠ¡
```bash
# å¯åŠ¨æ•°æ®åº“å’ŒLDAP
docker compose up -d db ldap
```

### 2. åˆå§‹åŒ–ç³»ç»Ÿ
```bash
cd backend
npm install
npm run init                    # è¿è¡Œå®Œæ•´åˆå§‹åŒ–
# æˆ–
npm run check-ldap             # ä»…æ£€æŸ¥LDAPé…ç½®
```

### 3. å¯åŠ¨åº”ç”¨æœåŠ¡
```bash
# åç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
cd backend
npm run dev

# å‰ç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
cd frontend
npm install
npm start
```

## ğŸ‘¤ é»˜è®¤è´¦å·ä¿¡æ¯

### PIç”¨æˆ·ï¼ˆLDAPè®¤è¯ï¼‰
- **ç”¨æˆ·å**: `pi001` | **å¯†ç **: `changeme123`
- **ç”¨æˆ·å**: `pi002` | **å¯†ç **: `changeme123`

### ç®¡ç†å‘˜ï¼ˆæ•°æ®åº“è®¤è¯ï¼‰
- **ç”¨æˆ·å**: `admin` | **å¯†ç **: `admin123`

### LDAPç®¡ç†å‘˜ï¼ˆé…ç½®çš„LDAPç”¨æˆ·ï¼‰
- åœ¨`.env`ä¸­é€šè¿‡`LDAP_ADMIN_USERS`é…ç½®
- ä½¿ç”¨LDAPå¯†ç ç™»å½•ç®¡ç†ç•Œé¢

## ğŸ”§ é…ç½®è¯´æ˜

### LDAPç®¡ç†å‘˜é…ç½®
åœ¨ `backend/.env` ä¸­æ·»åŠ ï¼š
```bash
# æŒ‡å®šLDAPä¸­çš„ç”¨æˆ·ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜
LDAP_ADMIN_USERS=pi001,admin-user,manager

# å¯ç”¨LDAPç®¡ç†å‘˜ç™»å½•
LDAP_ADMIN_LOGIN_ENABLED=true
```

è¿™äº›ç”¨æˆ·å°†ï¼š
1. è‡ªåŠ¨åœ¨æ•°æ®åº“ä¸­åˆ›å»ºç®¡ç†å‘˜è®°å½•
2. å¯ä»¥ä½¿ç”¨LDAPå¯†ç ç™»å½•ç®¡ç†ç•Œé¢
3. è·å¾—ç®¡ç†å‘˜æƒé™

### ä¸åŒLDAPæœåŠ¡å™¨é…ç½®ç¤ºä¾‹

**Active Directory:**
```bash
LDAP_URL=ldap://ad.company.com:389
LDAP_BIND_DN=CN=service-account,OU=Service Accounts,DC=company,DC=com
LDAP_BASE_DN=DC=company,DC=com
LDAP_PI_OU=OU=Faculty,OU=Users
LDAP_STUDENT_OU=OU=Students,OU=Users
```

**OpenLDAP:**
```bash
LDAP_URL=ldap://openldap.company.com:389
LDAP_BIND_DN=cn=admin,dc=company,dc=com
LDAP_BASE_DN=dc=company,dc=com
LDAP_PI_OU=ou=faculty
LDAP_STUDENT_OU=ou=students
```

## ğŸ› ï¸ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### ç³»ç»Ÿç®¡ç†
```bash
# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
docker compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker compose logs -f

# é‡å¯æœåŠ¡
docker compose restart

# æ£€æŸ¥LDAPé…ç½®
cd backend && npm run check-ldap
```

### ç”¨æˆ·ç®¡ç†
```bash
# ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
cd backend
npm run change-admin-password admin new-password

# æŸ¥çœ‹æ•°æ®åº“ä¸­çš„ç®¡ç†å‘˜
docker exec hpc-postgres psql -U user -d hpc_management -c "SELECT username, full_name, role FROM admins;"
```

### æ•°æ®åº“ç®¡ç†
```bash
# è¿æ¥æ•°æ®åº“
docker exec -it hpc-postgres psql -U user -d hpc_management

# æŸ¥çœ‹è¡¨ç»“æ„
docker exec hpc-postgres psql -U user -d hpc_management -c "\dt"
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **LDAPè¿æ¥å¤±è´¥**
   ```bash
   # æµ‹è¯•LDAPè¿æ¥
   cd backend && npm run check-ldap
   
   # æ‰‹åŠ¨æµ‹è¯•
   ldapsearch -x -H ldap://your-server:389 -D "cn=admin,dc=company,dc=com" -w password
   ```

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
   docker compose logs db
   
   # æµ‹è¯•è¿æ¥
   docker exec hpc-postgres psql -U user -d hpc_management -c "SELECT 1"
   ```

3. **ç«¯å£å†²çª**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -tlnp | grep :3000
   netstat -tlnp | grep :8000
   netstat -tlnp | grep :5433
   netstat -tlnp | grep :389
   ```

4. **æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
   chmod +x start-system.sh stop-system.sh
   ```

### é‡ç½®ç³»ç»Ÿ
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
./stop-system.sh

# æ¸…ç†æ•°æ®ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
docker compose down -v

# é‡æ–°å¯åŠ¨
./start-system.sh
```

## ğŸ“š æ›´å¤šæ–‡æ¡£

- [LDAPé…ç½®æŒ‡å—](LDAPé…ç½®æŒ‡å—.md) - è¯¦ç»†çš„LDAPé…ç½®è¯´æ˜
- [APIæ–‡æ¡£](docs/api.md) - åç«¯APIæ¥å£æ–‡æ¡£
- [éƒ¨ç½²æŒ‡å—](docs/deployment.md) - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è¯´æ˜

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
2. è¿è¡Œ `./start-system.sh --help` æŸ¥çœ‹é€‰é¡¹
3. æ£€æŸ¥é…ç½®æ–‡ä»¶ `backend/.env`
4. è¿è¡Œè¯Šæ–­è„šæœ¬ `npm run check-ldap`